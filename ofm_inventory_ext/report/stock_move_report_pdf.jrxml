<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.8.0.final using JasperReports Library version 4.0.0  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="stock_move_report_pdf" language="groovy" pageWidth="595" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="156"/>
	<property name="ireport.y" value="0"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="localhost_OFM_SALE_test"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<subDataset name="ds_logo_and_print_date">
		<queryString language="SQL">
			<![CDATA[SELECT value || '/web/binary/company_logo?dbname=' || current_database() AS company_logo,
(now() + INTERVAL '7 hour')::timestamp AS print_date
	    FROM ir_config_parameter
	    WHERE key = 'report.image.url']]>
		</queryString>
		<field name="company_logo" class="java.lang.String"/>
		<field name="print_date" class="java.sql.Timestamp"/>
	</subDataset>
	<parameter name="start_date" class="java.lang.String"/>
	<parameter name="end_date" class="java.lang.String"/>
	<parameter name="start_pid" class="java.lang.String"/>
	<parameter name="end_pid" class="java.lang.String"/>
	<parameter name="company_id" class="java.lang.String"/>
	<parameter name="branch_id" class="java.lang.String"/>
	<parameter name="status_type" class="java.lang.String"/>
	<queryString>
		<![CDATA[select rcn.name || ' ' ||
       case when pob.branch_id = '00000'
            then 'สำนักงานใหญ่'
            else 'สาขา' || pob.name ||
                 ' สาขาที่ ' || pob.branch_id
       end as company_name,
       (
        coalesce(pob.street, '') || ' ' ||
        coalesce(pob.moo || ' ', '') ||
        coalesce(pob.alley || ' ', '') ||
        coalesce(pob.street2, '')||
        '<br>' ||
        coalesce(case when pv.name like '%กรุงเทพ%'
                      then 'แขวง'
                      else 'ตำบล'
                 end || tmb.name, '') || ' ' ||
        coalesce(case when pv.name like '%กรุงเทพ%'
                      then 'เขต'
                      else 'อำเภอ'
                 end || amp.name, '') || ' ' ||
        coalesce(case when pv.name like '%กรุงเทพ%'
       	              then pv.name
	              else ('จังหวัด' || pv.name)
	         end, '') || ' ' ||
        coalesce(zp.name,'') || ' โทร : ' ||
        coalesce(pob.phone,'') ||
        '<br>' ||
        ' เลขประจำตัวผู้เสียภาษีอากร: ' || rpc.vat
       ) AS address_and_tax,
       coalesce(
                pos.doc_no,
		in_pco.doc_no,
		out_pco.doc_no,
		sod.name,
		sti.number,
		sim.name
	       ) as doc_no,
       spk.name as ref_doc_no,
       move_date + interval '7 hours' move_date,
       prp.id as product_id,
       (
        (coalesce(prp.default_code::varchar, '') || ' ' ) ||
        coalesce(ptp.name, '')
       ) as pid_product_name,
       pum.name as product_uom,
       avp.product_uom_qty,
       move_amount,
       price,
       remain_product_qty,
       remain_product_amount,
       product_average_price,
       pob.id as branch_id
from (
      select *
      from average_price
      /* Parameter month & year */
      where (DATE(move_date + interval '7 hour') between $P{start_date}::DATE and $P{end_date}::DATE)
     ) avp
left join (
	   select pod.id as pos_id,
	          coalesce(pod.inv_no, aiv.number) as doc_no
	   from pos_order pod
	   left join (
	              select *
		      from account_invoice
		      where type in ($P{status_type})
		      --('out_invoice', 'out_refund')
		            and state in ('open', 'paid')) aiv on pod.id = aiv.pos_id
	  ) pos on avp.pos_id = pos.pos_id
left join (
	   select coalesce(po_in_aiv.number) as doc_no,
	          po_in_stk.id as picking_id
	   from purchase_order puo
	   inner join stock_picking po_in_stk on puo.group_id = po_in_stk.group_id
	   inner join (
		       select *
		       from account_invoice
		       where type = 'in_invoice'
		             and state in ('open', 'paid')
		      ) po_in_aiv on po_in_stk.id = po_in_aiv.picking_id
	  ) in_pco on in_pco.picking_id = avp.picking_id
left join (
	   select coalesce(new_aiv.number) as doc_no,
	          po_out_stk.id as picking_id
	   from purchase_order puo
	   inner join stock_picking po_out_stk on puo.group_id = po_out_stk.group_id
	   inner join (
		       select *
		       from account_invoice
		       where type = 'in_refund'
		             and state in ('open', 'paid')
		      ) new_aiv on po_out_stk.id = new_aiv.picking_id
	  ) out_pco on out_pco.picking_id = avp.picking_id
	  	  
left join (

	select 
		sod.id as id,
		coalesce(aiv.number, aiv_inv.number, sod.name) as name,
		sod.procurement_group_id,
		stk.id as picking_id,
		case when aiv.type = 'out_refund'
				then 'RT_SO'
			  else 'SO'
		end as type      
	from sale_order sod
	left join stock_picking stk on stk.group_id = sod.procurement_group_id
	left join (
	              select id, so_id, number, 
			type,
		        picking_id
		      from account_invoice
		      where so_id is not null
			and type in ('out_refund')
		        and state in ('open', 'paid')
	    ) aiv on aiv.picking_id = stk.id 
	left join (
	              select id, so_id, number, 
			type,
		        picking_id
		      from account_invoice
		      where so_id is not null
			and type in ('out_invoice')
		        and state in ('open', 'paid')
	    ) aiv_inv on aiv_inv.so_id = sod.id
) sod on sod.id = avp.so_id and sod.type = avp.move_type and sod.picking_id = avp.picking_id

left join stock_inventory sti on avp.sa_id = sti.id
left join ofm_stock_internal_move sim on avp.int_id = sim.id
LEFT join stock_picking spk on spk.id = avp.picking_id
inner join (
            select *
	    from product_product
	    where coalesce(default_code, '0')::varchar between $P{start_pid} and $P{end_pid}
           ) prp on avp.product_id = prp.id
inner join product_template ptp on prp.product_tmpl_id = ptp.id
inner join product_category pcg on ptp.categ_id = pcg.id
inner join product_uom pum on avp.product_uom_id = pum.id
inner join (
	    select *
            from pos_branch
            /* Parameter branch_id */
            where id = $P{branch_id}::integer or COALESCE($P{branch_id}, '') = ''
           ) pob on avp.branch_id = pob.id
INNER JOIN (
	    SELECT *
	    from res_company
	    /* Parameter company_id */
	    where id = $P{company_id}::integer or COALESCE($P{company_id}, '') = ''
	   ) rcn on pob.pos_company_id = rcn.id
INNER JOIN res_partner rpc on rcn.partner_id = rpc.id
INNER JOIN province pv ON pob.province_id = pv.id
INNER JOIN amphur amp ON pob.amphur_id = amp.id
INNER JOIN tambon tmb ON pob.tambon_id = tmb.id
INNER JOIN zip zp ON pob.zip_id = zp.id
order by pob.id,
         prp.default_code,
         avp.move_date,
         avp.id]]>
	</queryString>
	<field name="company_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="company_name"/>
		<fieldDescription><![CDATA[Company Name]]></fieldDescription>
	</field>
	<field name="address_and_tax" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="address_and_tax"/>
	</field>
	<field name="doc_no" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="doc_no"/>
	</field>
	<field name="ref_doc_no" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="ref_doc_no"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="stock_picking"/>
	</field>
	<field name="move_date" class="java.sql.Timestamp">
		<property name="com.jaspersoft.studio.field.label" value="move_date"/>
		<fieldDescription><![CDATA[Move Date]]></fieldDescription>
	</field>
	<field name="product_id" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="product_id"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="product_product"/>
		<fieldDescription><![CDATA[Product]]></fieldDescription>
	</field>
	<field name="pid_product_name" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="pid_product_name"/>
	</field>
	<field name="product_uom" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="product_uom"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="product_uom"/>
		<fieldDescription><![CDATA[Product Unit of Measure]]></fieldDescription>
	</field>
	<field name="product_uom_qty" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="product_uom_qty"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="average_price"/>
		<fieldDescription><![CDATA[QTY]]></fieldDescription>
	</field>
	<field name="move_amount" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.label" value="move_amount"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="average_price"/>
		<fieldDescription><![CDATA[Move Amount]]></fieldDescription>
	</field>
	<field name="price" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.label" value="price"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="average_price"/>
		<fieldDescription><![CDATA[Price]]></fieldDescription>
	</field>
	<field name="remain_product_qty" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="remain_product_qty"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="average_price"/>
		<fieldDescription><![CDATA[Remain Product QTY]]></fieldDescription>
	</field>
	<field name="remain_product_amount" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.label" value="remain_product_amount"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="average_price"/>
		<fieldDescription><![CDATA[Remain Product Amount]]></fieldDescription>
	</field>
	<field name="product_average_price" class="java.lang.Double">
		<property name="com.jaspersoft.studio.field.label" value="product_average_price"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="average_price"/>
		<fieldDescription><![CDATA[Product Average Price]]></fieldDescription>
	</field>
	<field name="branch_id" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="branch_id"/>
		<property name="com.jaspersoft.studio.field.tree.path" value="pos_branch"/>
		<fieldDescription><![CDATA[Branch]]></fieldDescription>
	</field>
	<variable name="date_start" class="java.util.Date" resetType="Page">
		<initialValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse($P{start_date})]]></initialValueExpression>
	</variable>
	<variable name="date_end" class="java.util.Date" resetType="Page">
		<initialValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse($P{end_date})]]></initialValueExpression>
	</variable>
	<variable name="last_remain_qty" class="java.lang.Integer" resetType="Group" resetGroup="roduct_group">
		<variableExpression><![CDATA[$F{remain_product_qty}]]></variableExpression>
	</variable>
	<variable name="last_remain_amount" class="java.math.BigDecimal" resetType="Group" resetGroup="roduct_group">
		<variableExpression><![CDATA[$F{remain_product_amount}]]></variableExpression>
	</variable>
	<variable name="last_average_price" class="java.math.BigDecimal" resetType="Group" resetGroup="roduct_group">
		<variableExpression><![CDATA[$F{product_average_price}]]></variableExpression>
	</variable>
	<variable name="sum_last_remain_amount" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$V{last_remain_amount}]]></variableExpression>
	</variable>
	<filterExpression><![CDATA[($P{status_type} == "less_zero") ? $F{product_uom_qty} < 0 : ($P{status_type} == "more_zero") ? $F{product_uom_qty} > 0 :   $F{product_uom_qty} != 0]]></filterExpression>
	<group name="Branch Group" isStartNewPage="true" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{branch_id}]]></groupExpression>
		<groupHeader>
			<band height="126">
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement positionType="Float" mode="Transparent" x="120" y="17" width="315" height="41" forecolor="#000000" backcolor="#FFFFFF"/>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="html">
						<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{address_and_tax}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement mode="Transparent" x="0" y="62" width="555" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="16" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[รายงานความเคลื่อนไหวสินค้าคงคลัง]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="0" y="113" width="90" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[เลขที่]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="90" y="113" width="90" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[เลขที่อ้างอิง]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="180" y="113" width="52" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[วันที่]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="232" y="113" width="41" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[หน่วย]]></text>
				</staticText>
				<componentElement>
					<reportElement key="table 2" x="0" y="17" width="120" height="41"/>
					<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
						<datasetRun subDataset="ds_logo_and_print_date">
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:column width="120">
							<jr:detailCell height="41" rowSpan="1">
								<image>
									<reportElement x="0" y="0" width="120" height="41"/>
									<imageExpression class="java.lang.String"><![CDATA[$F{company_logo}]]></imageExpression>
								</image>
							</jr:detailCell>
						</jr:column>
					</jr:table>
				</componentElement>
				<staticText>
					<reportElement mode="Transparent" x="273" y="113" width="29" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[จำนวน]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="302" y="113" width="69" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[มูลค่า]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="273" y="100" width="141" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="0.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[สินค้าเคลื่อนไหว]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="371" y="113" width="43" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[@หน่วย]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="443" y="113" width="69" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[มูลค่า]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="414" y="100" width="141" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="0.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[สินค้าคงเหลือ]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="512" y="113" width="43" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[@หน่วย]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="414" y="113" width="29" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[จำนวน]]></text>
				</staticText>
				<staticText>
					<reportElement mode="Transparent" x="0" y="100" width="273" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="0.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="9" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<textField isStretchWithOverflow="true">
					<reportElement positionType="Float" mode="Transparent" x="0" y="0" width="555" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{company_name}]]></textFieldExpression>
				</textField>
				<textField pattern="" isBlankWhenNull="true">
					<reportElement mode="Transparent" x="0" y="82" width="555" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
					<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[" วันที่ " + new SimpleDateFormat("dd/MM/yyyy").format($V{date_start}) + " ถึง " +new SimpleDateFormat("dd/MM/yyyy").format($V{date_end})]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement mode="Transparent" x="435" y="33" width="40" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
					<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[หน้า:]]></text>
				</staticText>
				<textField>
					<reportElement mode="Transparent" x="475" y="33" width="18" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
					<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement mode="Transparent" x="435" y="17" width="40" height="16" forecolor="#000000" backcolor="#FFFFFF"/>
					<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[วันที่พิมพ์:]]></text>
				</staticText>
				<textField evaluationTime="Auto">
					<reportElement mode="Transparent" x="493" y="33" width="62" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
					<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["/ " + $V{PAGE_NUMBER}]]></textFieldExpression>
				</textField>
				<componentElement>
					<reportElement key="table 2" x="475" y="17" width="80" height="16"/>
					<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
						<datasetRun subDataset="ds_logo_and_print_date">
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
						<jr:column width="93">
							<jr:detailCell height="16" rowSpan="1">
								<textField pattern="dd/MM/yyyy HH:mm" isBlankWhenNull="false">
									<reportElement positionType="Float" mode="Transparent" x="0" y="0" width="93" height="16" forecolor="#000000" backcolor="#FFFFFF"/>
									<textElement verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
										<font fontName="TH SarabunPSK" size="12" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
									</textElement>
									<textFieldExpression class="java.util.Date"><![CDATA[$F{print_date}]]></textFieldExpression>
								</textField>
							</jr:detailCell>
						</jr:column>
					</jr:table>
				</componentElement>
			</band>
		</groupHeader>
	</group>
	<group name="roduct_group" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{product_id}]]></groupExpression>
		<groupHeader>
			<band height="13">
				<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true">
					<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="0" y="0" width="555" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box leftPadding="5"/>
					<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{pid_product_name}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="13">
				<textField isStretchWithOverflow="true" pattern="#,##0;-#,##0" isBlankWhenNull="true">
					<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="414" y="0" width="29" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box leftPadding="5">
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$V{last_remain_qty}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement mode="Transparent" x="0" y="0" width="414" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="0.0"/>
						<leftPen lineWidth="0.0"/>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<text><![CDATA[คงเหลือ **]]></text>
				</staticText>
				<textField isStretchWithOverflow="true" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
					<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="443" y="0" width="69" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box leftPadding="5">
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{last_remain_amount}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
					<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="512" y="0" width="43" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
					<box leftPadding="5">
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{last_average_price}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<detail>
		<band height="13">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="90" y="0" width="90" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{ref_doc_no}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="0" y="0" width="90" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{doc_no}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="180" y="0" width="52" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{move_date}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="232" y="0" width="41" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{product_uom}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0;-#,##0" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="273" y="0" width="29" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{product_uom_qty}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0;-#,##0" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="414" y="0" width="29" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{remain_product_qty}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="302" y="0" width="69" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{move_amount}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="371" y="0" width="43" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{price}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="443" y="0" width="69" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{remain_product_amount}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement stretchType="RelativeToTallestObject" mode="Transparent" x="512" y="0" width="43" height="13" forecolor="#000000" backcolor="#FFFFFF"/>
				<box leftPadding="5"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{product_average_price}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<noData>
		<band height="20">
			<staticText>
				<reportElement x="0" y="0" width="555" height="20"/>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[No Data]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
