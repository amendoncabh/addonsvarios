<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="best_seller_for_each_branches_report" language="groovy" pageWidth="595" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="553" leftMargin="21" rightMargin="21" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="net.sf.jasperreports.export.xls.white.page.background" value="false"/>
	<parameter name="start_date" class="java.lang.String"/>
	<parameter name="end_date" class="java.lang.String"/>
	<parameter name="branch_id" class="java.lang.String"/>
	<parameter name="sort_by_type" class="java.lang.String"/>
	<parameter name="start_branch" class="java.lang.String"/>
	<parameter name="end_branch" class="java.lang.String"/>
	<queryString>
		<![CDATA[select
categories_id,
product,
qty_line,
discount_amount,
price_line,
Total_price,
company_name,
branch_name,
branch_id,
street,
street2,
city,
zip,
phone,
province ,
print_date,
print_time,
start_branch_name,
end_branch_name,
start_branch_id,
end_branch_id,
price_unit,
title,
internal_ref,
(
	select sum(sum_qty)

	from
	(
		select  sum(pol1.qty) as sum_qty

		from pos_order po1
		left join pos_order_line pol1 on po1.id=pol1.order_id
		LEFT JOIN pos_session ps1 ON po1.session_id = ps1.id
		LEFT JOIN pos_config pf1 ON ps1.config_id = pf1.id
		LEFT JOIN pos_branch pb1 ON pf1.branch_id = pb1.id
		left JOIN product_product pp1 ON pol1.product_id = pp1.id
		left JOIN product_template pt1 ON pp1.product_tmpl_id = pt1.id
		left JOIN product_category pcg1 ON pt1.categ_id = pcg1.id
		where DATE(po1.date_order+interval '7 hours') BETWEEN
		$P{start_date}::date AND  $P{end_date}::date
		and pb1.id=branch
		and pol1.qty>0
		and pol1.price_unit >=0
		group by pcg1.id,pcg1.name
		) as temp

	) as qty_all,

(
	select sum(total_price)
	from(
		select sum((pol1.price_unit*pol1.qty)-(pol1.discount_amount)) as total_price
		from pos_order po1
		left join pos_order_line pol1 on po1.id=pol1.order_id
		LEFT JOIN pos_session ps1 ON po1.session_id = ps1.id
		LEFT JOIN pos_config pf1 ON ps1.config_id = pf1.id
		LEFT JOIN pos_branch pb1 ON pf1.branch_id = pb1.id
		left JOIN product_product pp1 ON pol1.product_id = pp1.id
		left JOIN product_template pt1 ON pp1.product_tmpl_id = pt1.id
		left JOIN product_category pcg1 ON pt1.categ_id = pcg1.id
		where DATE(po1.date_order+interval '7 hours') BETWEEN
		$P{start_date}::date AND  $P{end_date}::date
		and pb1.id =branch
		and pol1.qty>0
		and pol1.price_unit>0
		group by pcg1.id,pcg1.name


		)as temp

	)as total_price_all,
(
	select sum(total_price)
	from(
		select sum(pol1.price_unit*pol1.qty) as total_price
		from pos_order po1
		left join pos_order_line pol1 on po1.id=pol1.order_id
		LEFT JOIN pos_session ps1 ON po1.session_id = ps1.id
		LEFT JOIN pos_config pf1 ON ps1.config_id = pf1.id
		LEFT JOIN pos_branch pb1 ON pf1.branch_id = pb1.id
		left JOIN product_product pp1 ON pol1.product_id = pp1.id
		left JOIN product_template pt1 ON pp1.product_tmpl_id = pt1.id
		left JOIN product_category pcg1 ON pt1.categ_id = pcg1.id
		where DATE(po1.date_order+interval '7 hours') BETWEEN
		$P{start_date}::date AND    $P{end_date}::date
		and pb1.id=branch
		and pol1.qty>0
		and pol1.price_unit>0
		group by pcg1.id,pcg1.name
		)as temp
	)as price_all

from(
	select
	to_char(pcg.id, '99909') as categories_id,
	pt.name as product,
	sum(pol.qty) as qty_line,
	pol.price_unit as price_unit,
	sum(pol.discount_amount) as discount_amount,
	sum(pol.price_unit*pol.qty) as price_line,
	sum((pol.price_unit*pol.qty)-(pol.discount_amount)) as Total_price,
	rpc.name as company_name,
	pb.branch_name,
	pb.branch_id,
	pb.id as branch,
	rpc.street,
	rpc.street2,
	rpc.city,
	rpc.zip,
	rpc.phone,
	pp.default_code as internal_ref,
	rcs.name as province ,
	(now()+interval '7 hour')::date as print_date,
	(now()+interval '7 hour')::time as print_time,
	(case when $P{sort_by_type}::integer=0 then 'เรียงลำดับตาม  ลำดับสินค้า'
		when $P{sort_by_type}::integer=1 then 'เรียงลำดับตาม  จำนวนเงิน'
		when $P{sort_by_type}::integer=2 then 'เรียงลำดับตาม  จำนวนสินค้า' end ) as title,
	(
		select branch_name
		from
		(
			select pb1.branch_name as branch_name
			from  pos_branch pb1
			where pb1.sequence = $P{start_branch}::integer
			) as temp
		) as start_branch_name,
	(
		select branch_name
		from
		(
			select pb1.branch_name as branch_name
			from  pos_branch pb1
			where pb1.sequence = $P{end_branch}::integer
			) as temp
		) as end_branch_name,
	(
		select branch_id
		from
		(
			select pb1.branch_id as branch_id
			from  pos_branch pb1
			where pb1.sequence = $P{start_branch}::integer
			) as temp
		) as start_branch_id,
	(
		select branch_id
		from
		(
			select pb1.branch_id as branch_id
			from  pos_branch pb1
			where pb1.sequence = $P{end_branch}::integer
			) as temp
		) as end_branch_id
	from pos_order po
	LEFT JOIN pos_session ps ON po.session_id = ps.id
	LEFT JOIN pos_config pf ON ps.config_id = pf.id
	LEFT JOIN pos_branch pb ON pf.branch_id = pb.id
	LEFT JOIN res_company pc ON pb.pos_company_id = pc.id
	LEFT JOIN res_partner rpc ON pc.partner_id = rpc.id
	left join pos_order_line pol on po.id=pol.order_id
	left join res_users ru on ru.id=po.company_id
	left join res_country_state rcs on rpc.state_id=rcs.id
	left join res_partner rp on rp.id=rpc.id
	left JOIN product_product pp ON pol.product_id = pp.id
	left JOIN product_template pt ON pp.product_tmpl_id = pt.id
	left JOIN product_category pcg ON pt.categ_id = pcg.id
	where DATE(po.date_order+interval '7 hours') BETWEEN
	$P{start_date}::date AND  $P{end_date}::date
	and pb.sequence BETWEEN $P{start_branch}::integer and $P{end_branch}::integer
	and pol.qty>0
	and pol.price_unit >=0
	group by pcg.id,
	pt.name,
	pb.branch_name,
	pb.id,
	pb.branch_id,
	rpc.id,
	rcs.name ,
	pol.price_unit,
	pp.default_code
	order by pb.branch_id,(case when $P{sort_by_type}::integer=0 then pp.default_code end) , ((case when $P{sort_by_type}::integer=2 then sum(pol.qty) end) ) DESC  , (case when $P{sort_by_type}::integer=1 then sum(pol.price_unit*pol.qty) end) DESC

	) as test]]>
	</queryString>
	<field name="categories_id" class="java.lang.String"/>
	<field name="product" class="java.lang.String"/>
	<field name="qty_line" class="java.math.BigDecimal"/>
	<field name="discount_amount" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[Discount]]></fieldDescription>
	</field>
	<field name="price_line" class="java.math.BigDecimal"/>
	<field name="total_price" class="java.math.BigDecimal"/>
	<field name="company_name" class="java.lang.String">
		<fieldDescription><![CDATA[Company Name]]></fieldDescription>
	</field>
	<field name="branch_name" class="java.lang.String">
		<fieldDescription><![CDATA[Branch Name]]></fieldDescription>
	</field>
	<field name="branch_id" class="java.lang.String">
		<fieldDescription><![CDATA[Branch]]></fieldDescription>
	</field>
	<field name="street" class="java.lang.String">
		<fieldDescription><![CDATA[Street]]></fieldDescription>
	</field>
	<field name="street2" class="java.lang.String">
		<fieldDescription><![CDATA[Street2]]></fieldDescription>
	</field>
	<field name="city" class="java.lang.String">
		<fieldDescription><![CDATA[City]]></fieldDescription>
	</field>
	<field name="zip" class="java.lang.String">
		<fieldDescription><![CDATA[Zip]]></fieldDescription>
	</field>
	<field name="phone" class="java.lang.String">
		<fieldDescription><![CDATA[Phone]]></fieldDescription>
	</field>
	<field name="province" class="java.lang.String"/>
	<field name="print_date" class="java.sql.Date"/>
	<field name="print_time" class="java.sql.Time"/>
	<field name="start_branch_name" class="java.lang.String"/>
	<field name="end_branch_name" class="java.lang.String"/>
	<field name="start_branch_id" class="java.lang.String"/>
	<field name="end_branch_id" class="java.lang.String"/>
	<field name="price_unit" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[Unit Price]]></fieldDescription>
	</field>
	<field name="title" class="java.lang.String">
		<fieldDescription><![CDATA[Title]]></fieldDescription>
	</field>
	<field name="internal_ref" class="java.lang.String"/>
	<field name="qty_all" class="java.math.BigDecimal"/>
	<field name="total_price_all" class="java.math.BigDecimal"/>
	<field name="price_all" class="java.math.BigDecimal"/>
	<variable name="date_start" class="java.util.Date" resetType="Page">
		<initialValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse($P{start_date})]]></initialValueExpression>
	</variable>
	<variable name="date_end" class="java.util.Date" resetType="Page">
		<initialValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").parse($P{end_date})]]></initialValueExpression>
	</variable>
	<variable name="จำนวน%" class="java.math.BigDecimal">
		<variableExpression><![CDATA[(100*$F{qty_line})/$F{qty_all}]]></variableExpression>
	</variable>
	<variable name="มูลค่าขาย%" class="java.math.BigDecimal">
		<variableExpression><![CDATA[(100*$F{price_line})/$F{price_all}]]></variableExpression>
	</variable>
	<variable name="ยอดสุทธิ%" class="java.math.BigDecimal">
		<variableExpression><![CDATA[(100*$F{total_price})/$F{total_price_all}]]></variableExpression>
	</variable>
	<variable name="จำนวนทั้งหมด%" class="java.math.BigDecimal" resetType="Group" resetGroup="branch" calculation="Sum">
		<variableExpression><![CDATA[$V{จำนวน%}]]></variableExpression>
	</variable>
	<variable name="มูลค่าขายทั้งหมด%" class="java.math.BigDecimal" resetType="Group" resetGroup="branch" calculation="Sum">
		<variableExpression><![CDATA[$V{มูลค่าขาย%}]]></variableExpression>
	</variable>
	<variable name="ยอดสุทธิทั้งหมด%" class="java.math.BigDecimal" resetType="Group" resetGroup="branch" calculation="Sum">
		<variableExpression><![CDATA[$V{ยอดสุทธิ%}]]></variableExpression>
	</variable>
	<variable name="discount_amount_1" class="java.math.BigDecimal" resetType="Group" resetGroup="branch" calculation="Sum">
		<variableExpression><![CDATA[$F{discount_amount}]]></variableExpression>
	</variable>
	<variable name="qty_all" class="java.math.BigDecimal" resetType="Group" resetGroup="branch" calculation="Sum">
		<variableExpression><![CDATA[$F{qty_line}]]></variableExpression>
	</variable>
	<variable name="price_all" class="java.math.BigDecimal" resetType="Group" resetGroup="branch" calculation="Sum">
		<variableExpression><![CDATA[$F{price_line}]]></variableExpression>
	</variable>
	<variable name="total_price_all" class="java.math.BigDecimal" resetType="Group" resetGroup="branch" calculation="Sum">
		<variableExpression><![CDATA[$F{total_price}]]></variableExpression>
	</variable>
	<group name="branch" isStartNewPage="true">
		<groupExpression><![CDATA[$F{branch_name}]]></groupExpression>
		<groupFooter>
			<band height="20">
				<staticText>
					<reportElement mode="Transparent" x="0" y="0" width="176" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="2.0" lineStyle="Double"/>
					</box>
					<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[รวมทั้งหมด :]]></text>
				</staticText>
				<textField pattern="#,##0">
					<reportElement mode="Transparent" x="176" y="0" width="55" height="20" printWhenGroupChanges="branch" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="2.0" lineStyle="Double"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{qty_all}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement mode="Transparent" x="271" y="0" width="70" height="20" printWhenGroupChanges="branch" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="2.0" lineStyle="Double"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{price_all}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement mode="Transparent" x="444" y="0" width="75" height="20" printWhenGroupChanges="branch" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="2.0" lineStyle="Double"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{total_price_all}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement mode="Transparent" x="231" y="0" width="40" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="2.0" lineStyle="Double"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[new DecimalFormat( "#0.00" ).format($V{จำนวนทั้งหมด%})+"%"]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement mode="Transparent" x="341" y="0" width="48" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="2.0" lineStyle="Double"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$V{มูลค่าขายทั้งหมด%} < 0.0 ? new DecimalFormat( "-#,##0.00" ).format($V{มูลค่าขายทั้งหมด%})+"%" : new DecimalFormat( "#,##0.00" ).format($V{มูลค่าขายทั้งหมด%})+"%"]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement mode="Transparent" x="519" y="0" width="35" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="2.0" lineStyle="Double"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[new DecimalFormat( "#0.00" ).format($V{ยอดสุทธิทั้งหมด%})+"%"]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00;-#,##0.00">
					<reportElement mode="Transparent" x="389" y="0" width="55" height="20" printWhenGroupChanges="branch" forecolor="#000000" backcolor="#FFFFFF"/>
					<box>
						<topPen lineWidth="1.0"/>
						<bottomPen lineWidth="2.0" lineStyle="Double"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
						<font fontName="TH SarabunPSK" size="11" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<textFieldExpression class="java.math.BigDecimal"><![CDATA[$V{discount_amount_1}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="193" splitType="Stretch">
			<line>
				<reportElement mode="Transparent" x="0" y="192" width="553" height="1" forecolor="#000000" backcolor="#FFFFFF"/>
				<graphicElement>
					<pen lineWidth="2.0" lineStyle="Double"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement mode="Transparent" x="519" y="170" width="35" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[%]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="389" y="170" width="55" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[ส่วนลด]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="231" y="170" width="40" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[จำนวน%]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="271" y="170" width="70" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[มูลค่าขาย]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="176" y="170" width="55" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[จำนวน]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="131" y="170" width="45" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[ราคา/หน่วย]]></text>
			</staticText>
			<line>
				<reportElement mode="Transparent" x="0" y="167" width="553" height="1" forecolor="#000000" backcolor="#FFFFFF"/>
				<graphicElement>
					<pen lineWidth="2.0" lineStyle="Double"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement mode="Transparent" x="341" y="170" width="48" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[มูลค่าขาย%]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="444" y="170" width="75" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[ยอดขายสุทธิ]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="46" y="170" width="85" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[   ชื่อสินค้า]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="444" y="0" width="75" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[วันที่พิมพ์:]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="444" y="14" width="75" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[เวลาที่พิมพ์:]]></text>
			</staticText>
			<staticText>
				<reportElement mode="Transparent" x="444" y="28" width="75" height="19" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[หน้า:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement mode="Transparent" x="519" y="0" width="34" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{print_date}]]></textFieldExpression>
			</textField>
			<textField pattern="HH:mm:ss">
				<reportElement mode="Transparent" x="519" y="14" width="34" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{print_time}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Transparent" x="519" y="28" width="15" height="19" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}+"/"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement mode="Transparent" x="534" y="28" width="19" height="19" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Transparent" x="0" y="152" width="553" height="15" printWhenGroupChanges="branch" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[($F{branch_id} == '00000' ? " สำนักงานใหญ่" : " สาขาที่ "+String.format("%05d",Integer.parseInt($F{branch_id}))+" "+$F{branch_name})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Transparent" x="131" y="66" width="313" height="37" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="16" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[รายงานตามลำดับการขาย
Best Seller for Each Branches Report]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="131" y="28" width="313" height="19" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="16" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{company_name}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="131" y="103" width="313" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="14" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["("+$F{title}+")"]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="131" y="120" width="313" height="19" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new SimpleDateFormat("dd/MM/yyyy").format($V{date_start}) + " - " +new SimpleDateFormat("dd/MM/yyyy").format($V{date_end})]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="131" y="47" width="313" height="19" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="16" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[($P{start_branch} == $P{end_branch})? ("สาขาที่"+" "+String.format("%05d",Integer.parseInt($F{start_branch_id}))
+" "+$F{start_branch_name}):("สาขาที่"+" "+String.format("%05d",Integer.parseInt($F{start_branch_id}))
+" "+$F{start_branch_name}+" "
+" - "+"สาขาที่"+" "+String.format("%05d",Integer.parseInt($F{end_branch_id}))+" "+$F{end_branch_name}
)]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement mode="Transparent" x="0" y="170" width="46" height="17" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Left" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="13" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[รหัสสินค้า]]></text>
			</staticText>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="15" splitType="Stretch">
			<textField isStretchWithOverflow="true" pattern="">
				<reportElement mode="Transparent" x="46" y="0" width="130" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["  " + $F{product}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00">
				<reportElement mode="Transparent" x="131" y="0" width="45" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{price_unit}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="176" y="0" width="55" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{qty_line}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="271" y="0" width="70" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{price_line}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="389" y="0" width="55" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{discount_amount}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="444" y="0" width="75" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{total_price}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="231" y="0" width="40" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new DecimalFormat( "#0.00" ).format($V{จำนวน%})+"%"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="341" y="0" width="48" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{มูลค่าขาย%} < 0.0 ? new DecimalFormat( "-#,##0.00" ).format($V{มูลค่าขาย%})+"%" : new DecimalFormat( "#,##0.00" ).format($V{มูลค่าขาย%})+"%"]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00;-###0.00" isBlankWhenNull="false">
				<reportElement mode="Transparent" x="519" y="0" width="35" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Right" verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new DecimalFormat( "#0.00" ).format($V{ยอดสุทธิ%})+"%"]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement mode="Transparent" x="0" y="0" width="46" height="14" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="11" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun Bold.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{internal_ref}==null ? "-":$F{internal_ref}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="50" splitType="Stretch">
			<staticText>
				<reportElement positionType="Float" mode="Transparent" x="231" y="30" width="110" height="20" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="14" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[< สิ้นสุดรายงาน >]]></text>
			</staticText>
			<staticText>
				<reportElement positionType="Float" mode="Transparent" x="0" y="1" width="231" height="29" forecolor="#000000" backcolor="#FFFFFF"/>
				<textElement verticalAlignment="Top" rotation="None" lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" isBold="true" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="/usr/share/fonts/truetype/THSarabun.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[ยอดขายสุทธิ = มูลค่าขาย  - ส่วนลด
มูลค่าขาย = จำนวน * ราคาขายต่อหน่วย ณ วันที่ทำรายการ]]></text>
			</staticText>
		</band>
	</summary>
	<noData>
		<band height="20">
			<staticText>
				<reportElement x="0" y="0" width="553" height="20"/>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[No Data]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
